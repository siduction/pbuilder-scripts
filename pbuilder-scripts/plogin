#!/bin/bash
#
# plogin
#
# (c) 2011-2013 Alf Gaida <agaida@siduction.org>
#
export ARCH="amd64"
export DIST="unstable"
export RELEASE="unstable"
while getopts “a:r:sh” OPTION; do
     case ${OPTION} in
         a)
             ARCH=${OPTARG}
             export $ARCH
             ;;
         r)
             RELEASE=${OPTARG}
             export $RELEASE
             ;;
         s)
             SAVESETTINGS='--save-settings'
             ;;
         h)
             #usage
             exit
             ;;
     esac
done

case $ARCH in 
    i386)
        export debian_chroot="\[\033[1;33m\]pbuild-$RELEASE-$ARCH $$\[\033[0m\]"
        ;;
    amd64)
        export debian_chroot="\[\033[1;33m\]pbuild-$RELEASE-$ARCH $$\[\033[0m\]"
        ;;
esac

. /usr/share/pbuilder-scripts/set_pbuilder
export OLDGNUPGHOME=${GNUPGHOME}
export GNUPGHOME="/home/${BUILDER}/.gnupg"
sudo -E pbuilder --login ${@} ${SAVESETTINGS}

export GNUPGHOME=${OLDGNUPGHOME}
